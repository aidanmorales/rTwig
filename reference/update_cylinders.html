<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Update Cylinders — update_cylinders • rTwig</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Update Cylinders — update_cylinders"><meta name="description" content="Updates the QSM cylinder data in preparation for radii correction"><meta property="og:description" content="Updates the QSM cylinder data in preparation for radii correction"><meta property="og:image" content="https://aidanmorales.github.io/rTwig/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rTwig</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Box-Dimension.html">Box-Dimension</a></li>
    <li><a class="dropdown-item" href="../articles/Dictionary.html">Dictionary</a></li>
    <li><a class="dropdown-item" href="../articles/Metrics.html">Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/Overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/Twigs.html">Twigs</a></li>
    <li><a class="dropdown-item" href="../articles/Validation.html">Validation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aidanmorales/rTwig/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Update Cylinders</h1>
      <small class="dont-index">Source: <a href="https://github.com/aidanmorales/rTwig/blob/main/R/update_cylinders.R" class="external-link"><code>R/update_cylinders.R</code></a></small>
      <div class="d-none name"><code>update_cylinders.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Updates the QSM cylinder data in preparation for radii correction</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">update_cylinders</span><span class="op">(</span><span class="va">cylinder</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cylinder">cylinder<a class="anchor" aria-label="anchor" href="#arg-cylinder"></a></dt>
<dd><p>QSM cylinder data frame</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a data frame</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Updates parent-child branch and cylinder relationships to fill in any gaps.
Four useful QSM metrics developed by Jan Hackenberg are also calculated.
Growth length is the length of a parent cylinder, plus the lengths of all of
its child cylinders. The segment is a portion of a branch between two branching nodes.
The reverse branch order assigns twigs as order 1 and works backwards at each
branching junction to the base of the stem, which has the largest reverse branch order.
Distance from twig is the average distance to all connected twigs for a given cylinder.
Two new metrics, distance from base, and total children, are also calculated.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hackenberg J, Spiecker H, Calders K, Disney M, Raumonen P (2015).
“SimpleTree —An Efficient Open Source Tool to Build Tree Models from TLS Clouds.”
<em>Forests</em>, <b>6</b>(11), 4245–4294.
<a href="https://doi.org/10.3390/f6114245" class="external-link">doi:10.3390/f6114245</a>
.</p>
<p>Hackenberg J, Bontemps J (2023).
“Improving quantitative structure models with filters based on allometric scaling theory.”
<em>Applied Geomatics</em>, <b>15</b>.
<a href="https://doi.org/10.1007/s12518-023-00537-4" class="external-link">doi:10.1007/s12518-023-00537-4</a>
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## TreeQSM Processing Chain</span></span></span>
<span class="r-in"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/QSM.mat"</span>, package <span class="op">=</span> <span class="st">"rTwig"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="import_qsm.html">import_qsm</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Importing TreeQSM .mat</span>
<span class="r-in"><span><span class="va">cylinder</span> <span class="op">&lt;-</span> <span class="va">qsm</span><span class="op">$</span><span class="va">cylinder</span></span></span>
<span class="r-in"><span><span class="va">cylinder</span> <span class="op">&lt;-</span> <span class="fu">update_cylinders</span><span class="op">(</span><span class="va">cylinder</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Updating Cylinder Ordering</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Total Children</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building Cylinder Network</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Verifying Topology</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Growth Length</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Reverse Branch Order</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Branch Segments</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Alternate Branch Numbers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Distance From Base</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Average Distance To Twigs</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cylinder</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Classes ‘tidytable’, ‘tbl’, ‘data.table’ and 'data.frame':	1136 obs. of  29 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ radius            : num  0.0465 0.0454 0.0442 0.0437 0.0429 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ length            : num  0.09392 0.07216 0.06654 0.00938 0.06795 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ start.x           : num  0.768 0.768 0.768 0.769 0.769 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ start.y           : num  -16.4 -16.4 -16.4 -16.3 -16.3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ start.z           : num  254 254 254 254 254 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ axis.x            : num  0.00995 -0.0111 0.01364 0.01571 0.01449 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ axis.y            : num  0.0912 0.0391 0.0367 0.0271 0.0267 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ axis.z            : num  0.996 0.999 0.999 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ end.x             : num  0.769 0.768 0.769 0.769 0.77 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ end.y             : num  -16.4 -16.4 -16.3 -16.3 -16.3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ end.z             : num  254 254 254 254 254 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ added             : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BranchOrder       : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ reverseBranchOrder: num  20 20 20 20 20 20 20 20 20 20 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ PositionInBranch  : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ segment           : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ parentSegment     : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ mad               : num  0.00072 0.000538 0.000523 0.000335 0.000438 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ SurfCov           : num  0.875 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ UnmodRadius       : num  0.0465 0.0454 0.0442 0.0437 0.0429 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ OldRadius         : num  0.0465 0.0454 0.0442 0.0437 0.0429 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ growthLength      : num  32.8 32.7 32.6 32.6 32.6 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ branch            : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ branch_alt        : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ parent            : num  0 1 2 3 4 5 6 7 8 9 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ extension         : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ totalChildren     : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ distanceFromBase  : num  0.0939 0.1661 0.2326 0.242 0.31 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ distanceToTwig    : num  3.4 3.31 3.24 3.17 3.16 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## SimpleForest Processing Chain</span></span></span>
<span class="r-in"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/QSM.csv"</span>, package <span class="op">=</span> <span class="st">"rTwig"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cylinder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cylinder</span> <span class="op">&lt;-</span> <span class="fu">update_cylinders</span><span class="op">(</span><span class="va">cylinder</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Updating Branch Ordering</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Total Children</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building Cylinder Network</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Verifying Topology</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Distance From Base</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Average Distance To Twigs</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cylinder</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Classes ‘tidytable’, ‘tbl’, ‘data.table’ and 'data.frame':	1149 obs. of  26 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ID                  : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ parentID            : num  0 1 2 3 4 5 6 7 8 9 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ startX              : num  0.761 0.759 0.771 0.768 0.765 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ startY              : num  -16.4 -16.4 -16.4 -16.3 -16.4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ startZ              : num  254 254 254 254 254 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ endX                : num  0.759 0.771 0.768 0.765 0.769 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ endY                : num  -16.4 -16.4 -16.3 -16.4 -16.4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ endZ                : num  254 254 254 254 254 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ axisX               : num  -0.0286 0.2148 -0.0473 -0.0498 0.0678 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ axisY               : num  -0.078889 0.163918 0.03933 -0.011114 -0.000265 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ axisZ               : num  0.996 0.963 0.998 0.999 0.998 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ radius              : num  0.0472 0.0479 0.0469 0.0467 0.0453 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ length              : num  0.0497 0.0529 0.0535 0.0525 0.0528 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ growthLength        : num  31.4 31.4 31.3 31.3 31.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ averagePointDistance: num  0.00589 0.00378 0.00205 0.00246 0.00251 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ segmentID           : num  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ parentSegmentID     : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ branchOrder         : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ reverseBranchOrder  : int  18 18 18 18 18 18 18 18 18 18 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ UnmodRadius         : num  0.0472 0.0479 0.0469 0.0467 0.0453 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ branch_alt          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ positionInBranch    : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ branchID            : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ totalChildren       : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ distanceFromBase    : num  0.0497 0.1027 0.1562 0.2086 0.2614 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ distanceToTwig      : num  3.43 3.38 3.33 3.27 3.22 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aidan Morales, David W. MacFarlane.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

