<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Realistic Quantitative Structure Models â€¢ rTwig</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Realistic Quantitative Structure Models">
<meta name="description" content="Real Twig is a method to correct branch overestimation in quantitative structure models. Overestimated cylinders are correctly tapered using measured twig diameters of corresponding tree species. Supported quantitative structure modeling software includes TreeQSM, SimpleForest and Treegraph. Also included is a novel database of twig diameters and tools for fractal analysis of point clouds.">
<meta property="og:description" content="Real Twig is a method to correct branch overestimation in quantitative structure models. Overestimated cylinders are correctly tapered using measured twig diameters of corresponding tree species. Supported quantitative structure modeling software includes TreeQSM, SimpleForest and Treegraph. Also included is a novel database of twig diameters and tools for fractal analysis of point clouds.">
<meta property="og:image" content="https://aidanmorales.github.io/rTwig/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rTwig</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Box-Dimension.html">Box-Dimension</a></li>
    <li><a class="dropdown-item" href="articles/Dictionary.html">Dictionary</a></li>
    <li><a class="dropdown-item" href="articles/Metrics.html">Metrics</a></li>
    <li><a class="dropdown-item" href="articles/Overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="articles/Twigs.html">Twigs</a></li>
    <li><a class="dropdown-item" href="articles/Validation.html">Validation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aidanmorales/rTwig/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="rtwig-">rTwig <a class="anchor" aria-label="anchor" href="#rtwig-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- badges: end -->
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>Real Twig is a method to correct unrealistic cylinders in quantitative structure models (QSMs), different than traditional allometric or statistical corrections. Small branch and twig cylinders are overestimated in QSMs due to technical limitations in current LiDAR sensor technology. Real Twig overcomes these limitations by using real and direct twig diameter measurements from corresponding tree species to inform individual path taper models in a QSM. Real Twig dynamically identifies realistic cylinders in a QSM using network analysis, general additive models, and direct twig measurements, to model and correct unrealistic cylinders with a high degree of precision and accuracy when vetted against ground truth reference data. The Real Twig method is presented here as the R package, rTwig.</p>
<p>rTwig includes a novel database of twig diameter measurements for many common North American and European trees, to make the method immediately accessible to the user. In addition, rTwig includes fast and efficient tools for QSM visualization and analysis that are seamlessly compatible with the R ecosystem, and for point cloud fractal analysis and visualization using the box-dimension metric.</p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<div class="section level4">
<h4 id="realistic-trees">Realistic Trees<a class="anchor" aria-label="anchor" href="#realistic-trees"></a>
</h4>
<p>The main goal of Real Twig was to correct volume overestimation in QSMs caused by the limitations of LiDAR sensors for better non-destructive aboveground biomass estimates. Real Twig incorporates direct measurement into the QSM, resulting in models that not only have accurate volume metrics, but are also visually realistic, independent of tree species or size. Shown below is a 300+ year old white oak tree, with and without Real Twig.</p>
<p><img src="reference/figures/WO18_comparison.png"></p>
</div>
<div class="section level4">
<h4 id="efficient-visualization">Efficient Visualization<a class="anchor" aria-label="anchor" href="#efficient-visualization"></a>
</h4>
<p><code><a href="reference/plot_qsm.html">plot_qsm()</a></code> can plot QSMs and point clouds, using <code>rgl</code> as the 3D display, and C++ via <code>Rcpp</code> to efficiently build the cylinders. The cylinders, simulated point cloud, and skeleton can all be plotted and colored by any variable or user supplied color palette.</p>
<table class="table"><tbody>
<tr class="odd">
<td><img src="reference/figures/plot.gif" alt="Plot"></td>
<td><img src="reference/figures/WO7.gif" alt="Trees"></td>
</tr>
<tr class="even">
<td><img src="reference/figures/RO1.gif" alt="Plot"></td>
<td><img src="reference/figures/stand.gif" alt="Another"></td>
</tr>
</tbody></table>
</div>
<div class="section level4">
<h4 id="detailed-tree-metrics">Detailed Tree Metrics<a class="anchor" aria-label="anchor" href="#detailed-tree-metrics"></a>
</h4>
<p>The goal of rTwig was to provide users with tools to visualize and analyze QSM metrics without being tied to any particular QSM software. To that end, <code><a href="reference/tree_metrics.html">tree_metrics()</a></code> calculates all of the major QSM metrics between all supported software. Additionally, <code><a href="reference/standardize_qsm.html">standardize_qsm()</a></code> provides a consistent naming convention between supported QSMs, making it easy to combine and analyze QSMs from different sources. See the Dictionary and Metrics vignettes for more details.</p>
</div>
<div class="section level4">
<h4 id="supported-software">Supported Software<a class="anchor" aria-label="anchor" href="#supported-software"></a>
</h4>
<p>rTwig currently supports <a href="https://github.com/InverseTampere/TreeQSM" class="external-link">TreeQSM</a>, <a href="https://www.simpleforest.org/" class="external-link">SimpleForest</a>, <a href="https://github.com/wanxinyang/treegraph" class="external-link">Treegraph</a>, and <a href="https://github.com/umr-amap/aRchi" class="external-link">aRchi</a></p>
</div>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<ul>
<li>
<code><a href="reference/run_rtwig.html">run_rtwig()</a></code> runs the Real Twig method on a QSM</li>
<li>
<code><a href="reference/import_qsm.html">import_qsm()</a></code> imports a QSM created by TreeQSM (.mat)</li>
<li>
<code><a href="reference/import_treegraph.html">import_treegraph()</a></code> imports a QSM created by Treegraph (.json)</li>
<li>
<code><a href="reference/standardize_qsm.html">standardize_qsm()</a></code> standardizes QSM variable names across supported software</li>
<li>
<code><a href="reference/update_cylinders.html">update_cylinders()</a></code> updates cylinder relationships and adds new QSM variables</li>
<li>
<code>correct_radii</code> models QSM paths and corrects cylinder radii</li>
<li>
<code><a href="reference/tree_metrics.html">tree_metrics()</a></code> generates detailed tree metrics and a simulated point cloud</li>
<li>
<code><a href="reference/qsm_summary.html">qsm_summary()</a></code> summarizes QSM diameter, height, volume, and surface area</li>
<li>
<code><a href="reference/smooth_qsm.html">smooth_qsm()</a></code> connects cylinder end-to-end to smooth branch visualization</li>
<li>
<code><a href="reference/plot_qsm.html">plot_qsm()</a></code> plots QSMs and optionally their point clouds</li>
<li>
<code><a href="reference/export_mesh.html">export_mesh()</a></code> exports a QSM as a mesh object (.ply)</li>
<li>
<code><a href="reference/export_mat.html">export_mat()</a></code> exports a QSM in a MATLAB format (.mat)</li>
<li>
<code><a href="reference/box_dimension.html">box_dimension()</a></code> calculates and visualizes the structural complexity of a point cloud</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of <code>rTwig</code> from <a href="https://cran.r-project.org/package=rTwig" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rTwig"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of <code>rTwig</code> from <a href="https://github.com/aidanmorales/rTwig" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"aidanmorales/rTwig"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="quick-start-real-twig">Quick Start: Real Twig<a class="anchor" aria-label="anchor" href="#quick-start-real-twig"></a>
</h3>
<p>Below are examples of how to quickly run and visualize Real Twig, using example data from the package. See the vignettes for more details on a general workflow and best practices.</p>
<div class="section level4">
<h4 id="treeqsm">TreeQSM<a class="anchor" aria-label="anchor" href="#treeqsm"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Load the Real Twig library</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aidanmorales.github.io/rTwig/">rTwig</a></span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># File path to QSM</span></span>
<span> <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/QSM.mat"</span>, package <span class="op">=</span> <span class="st">"rTwig"</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Correct QSM cylinders</span></span>
<span> <span class="va">qsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_rtwig.html">run_rtwig</a></span><span class="op">(</span><span class="va">file</span>, twig_radius <span class="op">=</span> <span class="fl">4.23</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Plot the result</span></span>
<span> <span class="fu"><a href="reference/plot_qsm.html">plot_qsm</a></span><span class="op">(</span><span class="va">qsm</span><span class="op">$</span><span class="va">cylinder</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># View detailed tree metrics</span></span>
<span> <span class="va">qsm</span><span class="op">$</span><span class="va">metrics</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="simpleforest">SimpleForest<a class="anchor" aria-label="anchor" href="#simpleforest"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Load the Real Twig library</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aidanmorales.github.io/rTwig/">rTwig</a></span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># File path to QSM</span></span>
<span> <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/QSM.csv"</span>, package <span class="op">=</span> <span class="st">"rTwig"</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Correct QSM cylinders</span></span>
<span> <span class="va">qsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_rtwig.html">run_rtwig</a></span><span class="op">(</span><span class="va">file</span>, twig_radius <span class="op">=</span> <span class="fl">4.23</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Plot the result</span></span>
<span> <span class="fu"><a href="reference/plot_qsm.html">plot_qsm</a></span><span class="op">(</span><span class="va">qsm</span><span class="op">$</span><span class="va">cylinder</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># View detailed tree metrics</span></span>
<span> <span class="va">qsm</span><span class="op">$</span><span class="va">metrics</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="archi">aRchi<a class="anchor" aria-label="anchor" href="#archi"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Load the Real Twig library</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aidanmorales.github.io/rTwig/">rTwig</a></span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># File path to QSM</span></span>
<span> <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/QSM2.csv"</span>, package <span class="op">=</span> <span class="st">"rTwig"</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Correct QSM cylinders</span></span>
<span> <span class="va">qsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_rtwig.html">run_rtwig</a></span><span class="op">(</span><span class="va">file</span>, twig_radius <span class="op">=</span> <span class="fl">4.23</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Plot the result</span></span>
<span> <span class="fu"><a href="reference/plot_qsm.html">plot_qsm</a></span><span class="op">(</span><span class="va">qsm</span><span class="op">$</span><span class="va">cylinder</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># View detailed tree metrics</span></span>
<span> <span class="va">qsm</span><span class="op">$</span><span class="va">metrics</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="quick-start-fractal-analysis">Quick Start: Fractal Analysis<a class="anchor" aria-label="anchor" href="#quick-start-fractal-analysis"></a>
</h3>
<p>rTwig also includes an efficient function written in C++ via <code>Rcpp</code> for fractal analysis using the voxel-counting method. Below is an example of how to quickly calculate box-dimension on a point cloud using example data from the package. See the vignette for more details and explanation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a point cloud</span></span>
<span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cloud.txt"</span>, package <span class="op">=</span> <span class="st">"rTwig"</span><span class="op">)</span></span>
<span><span class="va">cloud</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate box-dimension</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/box_dimension.html">box_dimension</a></span><span class="op">(</span><span class="va">cloud</span><span class="op">)</span></span>
<span><span class="va">output</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">slope</span></span></code></pre></div>
<p><img src="reference/figures/box_dimension3d.png" align="center"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=rTwig" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/aidanmorales/rTwig/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/aidanmorales/rTwig/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rTwig</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Aidan Morales <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0009-0000-4513-4908" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>David W. MacFarlane <br><small class="roles"> Author, copyright holder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=rTwig" class="external-link"><img src="https://www.r-pkg.org/badges/version/rTwig"></a></li>
<li><a href="https://aidanmorales.r-universe.dev" class="external-link"><img src="https://aidanmorales.r-universe.dev/badges/rTwig"></a></li>
<li><a href="https://github.com/aidanmorales/rTwig/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/aidanmorales/rTwig/actions/workflows/R-CMD-check.yaml/badge.svg"></a></li>
<li><a href="https://github.com/aidanmorales/rTwig/commits/main" class="external-link"><img src="https://img.shields.io/github/last-commit/aidanmorales/rTwig.svg"></a></li>
<li><a href="https://cran.r-project.org/package=rTwig" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/rTwig"></a></li>
<li><a href="https://cran.r-project.org/package=rTwig" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/last-month/rTwig"></a></li>
<li><a href="https://cran.r-project.org/web/licenses/GPL-3" class="external-link"><img src="https://img.shields.io/badge/license-GPL%20(%3E=%203)-orchid.svg"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aidan Morales, David W. MacFarlane.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
